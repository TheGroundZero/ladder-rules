- domains: 
  - www.thestar.com
  - www.niagarafallsreview.ca
  - www.stcatharinesstandard.ca
  - www.thepeterboroughexaminer.com
  - www.therecord.com
  - www.thespec.com
  - www.wellandtribune.ca
  injections:
    - position: head
      append: |
        <script>
          window.localStorage.clear();
          document.addEventListener("DOMContentLoaded", () => {
            const paywall = document.querySelectorAll('div.subscriber-offers');
            paywall.forEach(el => { el.remove(); });
            const subscriber_only = document.querySelectorAll('div.subscriber-only');
            for (const elem of subscriber_only) {
              if (elem.classList.contains('encrypted-content') && dompurify_loaded) {
                const parser = new DOMParser();
                const doc = parser.parseFromString('<div>' + DOMPurify.sanitize(unscramble(elem.innerText)) + '</div>', 'text/html');
                const content_new = doc.querySelector('div');
                elem.parentNode.replaceChild(content_new, elem);
              }
              elem.removeAttribute('style');
              elem.removeAttribute('class');
            }
            const banners = document.querySelectorAll('div.subscription-required, div.redacted-overlay, div.subscriber-hide, div.tnt-ads-container');
            banners.forEach(el => { el.remove(); });
            const ads = document.querySelectorAll('div.tnt-ads-container, div[class*="adLabelWrapper"]');
            ads.forEach(el => { el.remove(); });
            const recommendations = document.querySelectorAll('div[id^="tncms-region-article"]');
            recommendations.forEach(el => { el.remove(); });
          });
        </script>
  tests:
  - url: https://www.wellandtribune.ca/news/niagara-region/niagara-transit-commission-rejects-council-request-to-reduce-its-budget-increase/article_e9fb424c-8df5-58ae-a6c3-3648e2a9df66.html
    test: document.querySelector('div.subscriber-offers') === null

- domains: 
  - www.nytimes.com
  - www.time.com
  headers:
    ueser-agent: Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
    cookie: nyt-a=; nyt-gdpr=0; nyt-geo=DE; nyt-privacy=1
    referer: https://www.google.com/ 
    content-security-policy: "default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;"
  injections:
    - position: head
      append: |
        <script>
          window.localStorage.clear();
          document.addEventListener("DOMContentLoaded", () => {
            const banners = document.querySelectorAll('div[data-testid="inline-message"], div[id^="ad-"], div[id^="leaderboard-"], div.expanded-dock, div.pz-ad-box, div[id="top-wrapper"], div[id="bottom-wrapper"]');
            banners.forEach(el => { el.remove(); });
          });
        </script>
  tests:
    - url: https://www.nytimes.com/2023/11/24/business/retail-workers-black-friday-shopping.html
      test: document.querySelector('div[data-testid="inline-message"]') === null
- domains: 
  - www.architecturaldigest.com
  - www.bonappetit.com
  - www.cntraveler.com
  - www.epicurious.com
  - www.gq.com
  - www.newyorker.com
  - www.vanityfair.com
  - www.vogue.com
  - www.wired.com
  injections:
    - position: head
      append: |
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const banners = document.querySelectorAll('.paywall-bar, div[class^="MessageBannerWrapper-"');
            banners.forEach(el => { el.remove(); });
          });
        </script>

- domain: americanbanker.com
  paths:
    - /news
  injections:
    - position: head
      append: |
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const inlineGate = document.querySelector('.inline-gate');
            if (inlineGate) {
              inlineGate.classList.remove('inline-gate');
              const inlineGated = document.querySelectorAll('.inline-gated');
              for (const elem of inlineGated) { elem.classList.remove('inline-gated'); }
            }
          });
        </script>
  tests:
    - url: https://www.americanbanker.com/news/how-foster-youth-become-financially-forgotten
      test: document.querySelector('.inline-gate') === null
- domain: www.washingtonpost.com
  injections:
    - position: head
      append: |
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            let paywall = document.querySelectorAll('div[data-qa$="-ad"], div[id="leaderboard-wrapper"], div[data-qa="subscribe-promo"]');
            paywall.forEach(el => { el.remove(); });
            const images = document.querySelectorAll('img');
            images.forEach(image => { image.parentElement.style.filter = ''; });
            const headimage = document.querySelectorAll('div .aspect-custom');
            headimage.forEach(image => { image.style.filter = ''; });
          });
        </script>
  tests:
    - url: https://www.washingtonpost.com/world/2023/11/24/russia-crimea-tunnel-china/
      test: document.querySelector('div[data-qa="subscribe-promo"]') === null
- domain: www.usatoday.com
  injections:
    - position: head
      append: |
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const banners = document.querySelectorAll('div.roadblock-container, .gnt_nb, [aria-label="advertisement"], div[id="main-frame-error"]');
            banners.forEach(el => { el.remove(); });
          });
        </script>

- domain: medium.com
  headers:
    referer: https://t.co/x?amp=1
    x-forwarded-for: none
    user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
    content-security-policy: script-src 'self';
    cookie: 

# loads amp version of page
- domain: tagesspiegel.de
  headers:
    content-security-policy: script-src 'self';
    user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
  urlMods:
    query:
      - key: amp
        value: 1
  tests:
    url: https://www.tagesspiegel.de/politik/impfungen-in-deutschland-und-der-welt-der-aktuelle-stand-der-impfkampagne/26809888.html
    test: document.querySelector('html').classList.contains('amp-mode')

- domain: www.nzz.ch
  paths:
    - /international
    - /sport
    - /wirtschaft
    - /technologie
    - /feuilleton
    - /zuerich
    - /wissenschaft
    - /gesellschaft
    - /panorama
    - /mobilitaet
    - /reisen
    - /meinung
    - /finanze
  injections:
    - position: head
      append: |
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const paywall = document.querySelector('.dynamic-regwall');
            removeDOMElement(paywall)
          });
        </script>
  tests:
    - url: https://www.nzz.ch/feuilleton/edward-w-said-der-ideologe-des-palaestinensischen-terrors-ld.1766658
      test: document.querySelector('.dynamic-regwall') === null

- domains:
  - myprivacy.dpgmedia.be
  - myprivacy.dpgmedia.nl
  headers:
    cookie: isBot=true; authId=1
    x-forwarded-for: none
    referer: https://news.google.com
- domains:
  - demorgen.be
  headers:
    cookie: isBot=true; authId=1
    user-agent: Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; Googlebot/2.1; Googlebot-News; +http://www.google.com/bot.html) Chrome/121.0.6140.0 Safari/537.36
    x-forwarded-for: none
    referer: https://news.google.com
    content-security-policy: "default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;"
  regexRules:
    - match: (\s&&\s)?window\.temptation(\s&&\s)?(\.init)?(\s&&\s)?(\(([^)]\s*)*\);)?
      replace: true
  injections:
    - position: head
      prepend: |
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            // remove paywall items
            let paywall = document.querySelectorAll('script[src*="advertising-cdn.dpgmedia.cloud"], div[data-temptation-position="ARTICLE_BOTTOM"]');
            paywall.forEach(el => { el.remove(); });
            // remove empty advert
            document.querySelector('div[data-advert-placeholder-collapses]').remove();
          });
        </script>
  tests:
    - url: https://www.demorgen.be/nieuws/verkiezingen-2024-zullen-uitdraaien-op-een-strijd-tussen-vivaldi-en-bourgeois-blok~b0f7b8a9/
      test: document.querySelector('div[data-temptation-position="ARTICLE_BOTTOM"]') === null

- domain: ft.com
  headers:
    referer: https://t.co/x?amp=1
    content-security-policy: "default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;"
  injections:
    - position: head
      append: |
        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const styleTags = document.querySelectorAll('link[rel="stylesheet"]');
            styleTags.forEach(el => { 
              const href = el.getAttribute('href').substring(1);
              const updatedHref = href.replace(/(https?:\/\/.+?)\/{2,}/, '$1/');
              el.setAttribute('href', updatedHref);
            });
            setTimeout(() => {
              const cookie = document.querySelectorAll('.o-cookie-message, .js-article-ribbon, .o-ads, .o-banner, .o-message, .article__content-sign-up');
              cookie.forEach(el => { el.remove(); });
            }, 1000);
          })
        </script>
  tests:
    - url: https://www.ft.com/content/5348ec64-010e-40f4-a27e-6d1252a0c537
      test: document.querySelector('.o-cookie-message') === null
